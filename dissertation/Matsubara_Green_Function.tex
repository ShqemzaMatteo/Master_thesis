\chapter{Matsubara Green Function} \label{Appendix_B}

The Matsubara Green function introduces the effect of temperature to the Quantum Field Theory formalism.
It is based on the analogy of the Boltzmann weight in statistical mechanics and the time evolution operator in quantum mechanics 
\begin{equation}
    p(\beta) = \frac{e^{-\beta H}}{Z} \qquad U(t-t') = e^{-i\frac{t-t'}{\hbar}\hat H} .
\end{equation}

Kubo observed that the finite temperature effects can be reformulated redefining the time as $\tau = \frac{it}{\hbar}$ and the density matrix becomes \cite{Coleman_2015}
\begin{equation}
    \hat \rho \propto e^{-\beta \hat H} = U(-i\hbar \beta).
\end{equation}

Matsubara proposed that the thermal expectation value of an observable $A$ is equal to  
\begin{equation}
    \left<A\right> = \frac{\Tr \left[U(-i\hbar \beta)A\right]}{\Tr\left[U(-i\hbar \beta)\right]};
\end{equation}
This formulation resembles the Gell-Mann and Low formula for the QFT except that the time evolution run over finite time $\tau \in \left[0,-i\hbar\beta\right]$\cite{Coleman_2015}.

The Matsubara Green Function is defined as 
\begin{equation}
    G(\beta, t-t') = - \left< \hat T \psi(t)\psi^\dagger(t') \right> = -\frac{\Tr\left[e^{-\beta\hat H} \psi(t)\psi^\dagger(t') \right]}{\Tr\left[e^{-\beta\hat H}\right]}
\end{equation}

For free bosons and fermions, we can compute Matsubara Green Function in the momentum space as \cite{Coleman_2015}
\begin{equation}
    \begin{split}
        G_{\lambda}(\beta, \tau) = -e^{-\epsilon_\lambda t}\left[(1+n(\epsilon_\lambda))\Theta(\tau)+n(\epsilon_\lambda)\Theta(-\tau)\right] \qquad \mathrm{bosons}\\
        G_{\lambda}(\beta, \tau) = -e^{-\epsilon_\lambda t}\left[(1-f(\epsilon_\lambda))\Theta(\tau)-f(\epsilon_\lambda)\Theta(-\tau)\right] \qquad \mathrm{fermion}\\
    \end{split}
\end{equation}
where $\epsilon_\lambda$ is the energy level, $n(\epsilon_\lambda)$ and $f(\epsilon_\lambda)$ are the Bose-Einstein distribution and the Fermi-Dirac distribution respectively
\begin{equation}
    n(\epsilon_\lambda) = \frac{1}{e^{\beta\epsilon_\lambda} - 1} \qquad\qquad f(\epsilon_\lambda) = \frac{1}{e^{\beta\epsilon_\lambda} + 1}.
\end{equation}

It can be shown that the Matsubara Green function is a periodic function with $T = [0,\beta]$ for bosons and $t = [-\beta, \beta]$ for fermions. Indeed
\begin{equation}
    \begin{split}
        G(\beta, \beta + \tau) &= -\Tr\left[e^{-\beta\hat H} \psi(\beta + \tau)\psi^\dagger(0) \right] \\
        &= -\Tr\left[e^{-\beta\hat H} e^{-(\beta + \tau)\hat H}\psi(0)e^{-(\beta+ \tau)\hat H}\psi^\dagger(0) \right]\\
        &= -\Tr\left[e^{-\beta\hat H} e^{\beta\hat H}e^{\tau\hat H}\psi(0)e^{-\beta\hat H}e^{-\tau\hat H}\psi^\dagger(0) \right]\\
        &= -\Tr\left[e^{-\beta\hat H}\psi^\dagger(0)e^{\tau\hat H}\psi(0)e^{-\tau\hat H}\right]\\
        &= -\Tr\left[e^{-\beta\hat H}\psi^\dagger(0)\psi(\tau)\right] = \zeta G(\beta,\tau) ;
    \end{split}
\end{equation}
where $\zeta = \pm 1$ for bosons or fermions. 

As a consequence, the Green function can be expanded in a Fourier series, the corresponding frequencies are called Matsubara frequencies. They are defined as 
\begin{equation}
    \begin{aligned}
        \nu_n =& 2\pi nk_BT \qquad &\mathrm{bosons}\\
        \omega_n =& \pi (2n+1)k_BT \qquad &\mathrm{fermions}\\
    \end{aligned}
\end{equation}
 
The propagators for bosons and fermion in term of Matsubara frequencies are respectively
\begin{equation}
    \mathcal{G}_\lambda(i\nu_n)= \frac{1}{i\nu_n - \epsilon_\lambda} \qquad \qquad\mathcal{G}_\lambda(i\omega_n)= \frac{1}{i\omega_n - \epsilon_\lambda}.
\end{equation}